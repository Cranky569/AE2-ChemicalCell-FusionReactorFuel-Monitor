-- Peripherals
local bridge = peripheral.find("meBridge") or peripheral.find("me_bridge") or peripheral.find("bridge")

if not bridge then
  error("ME Bridge / Chemical Bridge nicht gefunden.")
end

-- Sicherer Aufruf
local ok, chemicals_or_err = pcall(function() return bridge.getTotalChemicalStorage() end)

if not ok then
  print("Fehler beim Aufruf: " .. tostring(chemicals_or_err))
  return
end

if type(chemicals_or_err) ~= "table" then
  print("Rückgabewert ist kein table, sondern: " .. type(chemicals_or_err))
  print("Inhalt: " .. tostring(chemicals_or_err))
  return
end

-- Schöne Ausgabe
if textutils and textutils.serialize then
  print("=== Debug: bridge.getTotalChemicalStorage() ===")
  print(textutils.serialize(chemicals_or_err))
else
  -- Falls textutils nicht verfügbar
  print("=== Debug (roh) ===")
  for k,v in pairs(chemicals_or_err) do
    print(k, v)
  end
end
