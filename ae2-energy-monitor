local bridge = peripheral.find("me_bridge")
local monitor = peripheral.find("monitor")

if not bridge then error("No ME-Bridge found!") end
if not monitor then error("No monitor found!") end

-- List of fluids to display
local fluidsToShow = {
    "mekanismgenerators:tritium",
    "mekanismgenerators:deuterium",
    "mekanismgenerators:fusion_fuel"
}

-- Function to get color for each fluid
local function getColorForFluid(name)
    if name == "mekanismgenerators:tritium" then
        return colors.green
    elseif name == "mekanismgenerators:deuterium" then
        return colors.red
    elseif name == "mekanismgenerators:fusion_fuel" then
        return colors.purple
    else
        return colors.white
    end
end

-- Function to format fluid name nicely
local function formatName(name)
    return name:gsub("mekanismgenerators:", ""):gsub("_", " "):gsub("^%l", string.upper)
end

local function displayFluids()
    monitor.clear()
    monitor.setCursorPos(1,1)
    monitor.setTextColor(colors.yellow)
    monitor.write("Fusion Reactor Fuel")

    local line = 3 -- leave a blank line

    local fluids = bridge.getFluids()
    if not fluids or #fluids == 0 then
        monitor.setCursorPos(1,line)
        monitor.setTextColor(colors.white)
        monitor.write("No fluids found.")
        return
    end

    for _, fName in ipairs(fluidsToShow) do
        local found = false
        for _, f in ipairs(fluids) do
            if f.name == fName then
                monitor.setCursorPos(1,line)
                monitor.setTextColor(getColorForFluid(fName))
                monitor.write(string.format("%s: %d mB", formatName(fName), tonumber(f.amount) or 0))
                line = line + 1
                found = true
                break
            end
        end
        if not found then
            monitor.setCursorPos(1,line)
            monitor.setTextColor(getColorForFluid(fName))
            monitor.write(string.format("%s: 0 mB", formatName(fName)))
            line = line + 1
        end
    end
end

while true do
    displayFluids()
    sleep(5)
end
