local mon    = peripheral.find("monitor")
local bridge = peripheral.find("meBridge") or peripheral.find("me_bridge") or peripheral.find("bridge")

if not mon then error("Monitor nicht gefunden!") end
if not bridge then error("Bridge nicht gefunden!") end

mon.setTextScale(0.5)
mon.clear()
mon.setCursorPos(1,1)
mon.write("=== bridge.getChemicals() Debug ===")

local ok, chemicals_or_err = pcall(function() return bridge.getChemicals() end)
if not ok or type(chemicals_or_err) ~= "table" then
    mon.setCursorPos(1,3)
    mon.write("Fehler oder kein Table zurÃ¼ck")
    return
end

local row = 3
for _,entry in pairs(chemicals_or_err) do
    if type(entry) == "table" then
        local line = ""
        local count = 0
        for k,v in pairs(entry) do
            count = count + 1
            -- Bedingungen zum Ausblenden
            if count > 2 and k ~= "tags" and k ~= "fingerprint" and k ~= "isCraftable" then
                line = line .. k .. "=" .. tostring(v) .. " "
            end
        end
        mon.setCursorPos(1, row)
        mon.write(line)
    else
        mon.setCursorPos(1, row)
        mon.write(tostring(entry))
    end

    row = row + 1
    if row > mon.getSize() then
        mon.scroll(1)
        row = mon.getSize()
    end
end
